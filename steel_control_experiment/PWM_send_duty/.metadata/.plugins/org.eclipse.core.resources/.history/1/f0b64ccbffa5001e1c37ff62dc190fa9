//2023/07/05Å@PWMêßå‰

#include "sys/alt_stdio.h"
#include "system.h"
#include  <unistd.h>
#include "altera_avalon_pio_regs.h"

int main()
{
	  //é¸ä˙ÇÃê›íË
	IOWR_ALTERA_AVALON_PIO_DATA(CYCLE_BASE,125000);
        int sw_0=0x1;
        int sw_1=0x1;
        int dip_0=0x1;
        int dip_1=0x1;
        int dip_2=0x1;
        int dip_3=0x1;

        int status=0;

        IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,0);
        IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,0);
        IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,0);
        IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,0);
        while(1){
        	sw_0=IORD_ALTERA_AVALON_PIO_DATA(SW0_BASE);
        	if(sw_0==0x0){
        	    IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,116500);//100%

        	    IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,1);
        	    IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,1);

        	    break;
        	}
        }
        while(1){
        	if(sw_1==0x0){
        		IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,47000);//0%

        		IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,1);
        	    break;
        	}
        }
        while(1){
            if(sw_0==0x0){
                IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,50475);//5%

                IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,1);
                IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,0);
                IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,1);
                IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,0);

                usleep(1000000);
                break;
            }
        }

        while(1){
        	dip_0=IORD_ALTERA_AVALON_PIO_DATA(DIP0_BASE);
      	    dip_1=IORD_ALTERA_AVALON_PIO_DATA(DIP1_BASE);
      	    dip_2=IORD_ALTERA_AVALON_PIO_DATA(DIP2_BASE);
      	    dip_3=IORD_ALTERA_AVALON_PIO_DATA(DIP3_BASE);

      	    status=(dip_3<<3)|(dip_2<<2)|(dip_1<<1)|dip_0;

        	switch(status){
        	case 0:
        		IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,50475);//5%

        		IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,0);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,0);

        	case 1:
        		IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,53950);//10%

        		IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,0);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,0);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,1);

        	case 2:
        		IOWR_ALTERA_AVALON_PIO_DATA(DUTY_BASE,57425);//15%

        		IOWR_ALTERA_AVALON_PIO_DATA(LED0_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED1_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED2_BASE,1);
        		IOWR_ALTERA_AVALON_PIO_DATA(LED3_BASE,1);
        	}
        }
        return 0;
}

